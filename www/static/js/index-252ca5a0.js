var Ht=Object.defineProperty,Pt=Object.defineProperties;var $t=Object.getOwnPropertyDescriptors;var ct=Object.getOwnPropertySymbols;var Ut=Object.prototype.hasOwnProperty,Nt=Object.prototype.propertyIsEnumerable;var lt=(e,n,t)=>n in e?Ht(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Y=(e,n)=>{for(var t in n||(n={}))Ut.call(n,t)&&lt(e,t,n[t]);if(ct)for(var t of ct(n))Nt.call(n,t)&&lt(e,t,n[t]);return e},me=(e,n)=>Pt(e,$t(n));var we=(e,n,t)=>new Promise((a,o)=>{var d=m=>{try{y(t.next(m))}catch(h){o(h)}},f=m=>{try{y(t.throw(m))}catch(h){o(h)}},y=m=>m.done?a(m.value):Promise.resolve(m.value).then(d,f);y((t=t.apply(e,n)).next())});import{u as re,r as ae,t as oe,y as Ye,z as Kt,A as Yt,B as De,x as Gt,D as Xt,G as Ee,c as St,H as Ie,k as Wt,C as zt,I as B,J as Be,a as jt,b as wt,i as qt,O as Jt,g as Vt,d as Qt,e as Zt,h as en,F as tn,K as it,o as nn,f as sn}from"./useSync.hook-59c1bff9.js";import{x as ot,a6 as Tt,aJ as on,ah as D,c8 as xt,c9 as Dt,co as dt,cn as an,c5 as Ve,U as rn,cp as q,cd as Ge,ai as un,j as le,d as ue,bL as ke,f as s,u as Fe,a5 as $,o as T,m as j,n as at,F as he,A as _e,ad as de,aR as ne,aa as ce,z,c as P,w as A,L as Ce,bW as Qe,bX as He,bY as Ze,bZ as At,a4 as rt,y as $e,aj as ft,R as pe,r as I,cq as cn,a3 as Ue,v as Q,cr as pt,G as kt,H as Ft,e as L,p as ye,t as fe,aI as ln,aU as dn,cs as ve,ct as Pe,cu as fn,c4 as pn,cv as hn,ak as vn,cw as gn,J as bt,Q as ht,c1 as Xe,X as We,Y as ze,aY as _n,V as mn,cx as Cn,cy as yn,W as En,aP as Sn,S as Le,c2 as je}from"./index.js";import{u as ut,d as wn}from"./index-47869d1d.js";import{a as Tn,b as vt,l as xn,g as Dn}from"./plugin-b5a1ee69.js";import{C as An}from"./index-15c08608.js";import{i as Ae}from"./icon-868e01a0.js";import{E as kn}from"./index-2e8561b6.js";import{N as Fn}from"./NotFoundComponent-c4b4e010.js";import"./tables_list-553e31dd.js";import"./index-475a8029.js";import"./index-22052e6f.js";const Te=re(),bn=()=>{ot(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();Tt(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var Ot={exports:{}};(function(e){(function(n){var t,a={},o={16:!1,18:!1,17:!1,91:!1},d="all",f={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},y={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},m=function(u){return y[u]||u.toUpperCase().charCodeAt(0)},h=[];for(t=1;t<20;t++)y["f"+t]=111+t;function _(u,i){for(var k=u.length;k--;)if(u[k]===i)return k;return-1}function l(u,i){if(u.length!=i.length)return!1;for(var k=0;k<u.length;k++)if(u[k]!==i[k])return!1;return!0}var c={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function r(u){for(t in o)o[t]=u[c[t]]}function p(u){var i,k,F,X,N,ie;if(i=u.keyCode,_(h,i)==-1&&h.push(i),(i==93||i==224)&&(i=91),i in o){o[i]=!0;for(F in f)f[F]==i&&(S[F]=!0);return}if(r(u),!!S.filter.call(this,u)&&i in a){for(ie=W(),X=0;X<a[i].length;X++)if(k=a[i][X],k.scope==ie||k.scope=="all"){N=k.mods.length>0;for(F in o)(!o[F]&&_(k.mods,+F)>-1||o[F]&&_(k.mods,+F)==-1)&&(N=!1);(k.mods.length==0&&!o[16]&&!o[18]&&!o[17]&&!o[91]||N)&&k.method(u,k)===!1&&(u.preventDefault?u.preventDefault():u.returnValue=!1,u.stopPropagation&&u.stopPropagation(),u.cancelBubble&&(u.cancelBubble=!0))}}}function g(u){var i=u.keyCode,k,F=_(h,i);if(F>=0&&h.splice(F,1),(i==93||i==224)&&(i=91),i in o){o[i]=!1;for(k in f)f[k]==i&&(S[k]=!1)}}function C(){for(t in o)o[t]=!1;for(t in f)S[t]=!1}function S(u,i,k){var F,X;F=v(u),k===void 0&&(k=i,i="all");for(var N=0;N<F.length;N++)X=[],u=F[N].split("+"),u.length>1&&(X=H(u),u=[u[u.length-1]]),u=u[0],u=m(u),u in a||(a[u]=[]),a[u].push({shortcut:F[N],scope:i,method:k,key:F[N],mods:X})}function b(u,i){var k,F,X=[],N,ie,Se;for(k=v(u),ie=0;ie<k.length;ie++){if(F=k[ie].split("+"),F.length>1&&(X=H(F),u=F[F.length-1]),u=m(u),i===void 0&&(i=W()),!a[u])return;for(N=0;N<a[u].length;N++)Se=a[u][N],Se.scope===i&&l(Se.mods,X)&&(a[u][N]={})}}function M(u){return typeof u=="string"&&(u=m(u)),_(h,u)!=-1}function O(){return h.slice(0)}function U(u){var i=(u.target||u.srcElement).tagName;return!(i=="INPUT"||i=="SELECT"||i=="TEXTAREA")}for(t in f)S[t]=!1;function G(u){d=u||"all"}function W(){return d||"all"}function E(u){var i,k,F;for(i in a)for(k=a[i],F=0;F<k.length;)k[F].scope===u?k.splice(F,1):F++}function v(u){var i;return u=u.replace(/\s/g,""),i=u.split(","),i[i.length-1]==""&&(i[i.length-2]+=","),i}function H(u){for(var i=u.slice(0,u.length-1),k=0;k<i.length;k++)i[k]=f[i[k]];return i}function K(u,i,k){u.addEventListener?u.addEventListener(i,k,!1):u.attachEvent&&u.attachEvent("on"+i,function(){k(window.event)})}K(document,"keydown",function(u){p(u)}),K(document,"keyup",g),K(window,"focus",C);var x=n.key;function R(){var u=n.key;return n.key=x,u}n.key=S,n.key.setScope=G,n.key.getScope=W,n.key.deleteScope=E,n.key.filter=U,n.key.isPressed=M,n.key.getPressedKeyCodes=O,n.key.noConflict=R,n.key.unbind=b,e.exports=S})(on)})(Ot);var Z=Ot.exports;const ee=re(),se=e=>`${xt.CTRL}+${e}`,Me=e=>`${xt.SHIFT}+${e}`,J={[D.ARROW_UP]:se("up"),[D.ARROW_RIGHT]:se("right"),[D.ARROW_DOWN]:se("down"),[D.ARROW_LEFT]:se("left"),[D.COPY]:se("c"),[D.CUT]:se("x"),[D.PARSE]:se("v"),[D.DELETE]:"delete",[D.BACK]:se("z"),[D.FORWORD]:se(Me("z")),[D.GROUP]:se("g"),[D.UN_GROUP]:se(Me("g")),[D.LOCK]:se("l"),[D.UNLOCK]:se(Me("l")),[D.HIDE]:se("h"),[D.SHOW]:se(Me("h"))},te=e=>`${Dt.CTRL}+${e}`,Re=e=>`${Dt.SHIFT}+${e}`,V={[D.ARROW_UP]:te("arrowup"),[D.ARROW_RIGHT]:te("arrowright"),[D.ARROW_DOWN]:te("arrowdown"),[D.ARROW_LEFT]:te("arrowleft"),[D.COPY]:te("c"),[D.CUT]:te("x"),[D.PARSE]:te("v"),[D.DELETE]:te("backspace"),[D.BACK]:te("z"),[D.FORWORD]:te(Re("z")),[D.GROUP]:te("g"),[D.UN_GROUP]:te(Re("g")),[D.LOCK]:te("l"),[D.UNLOCK]:te(Re("l")),[D.HIDE]:te("h"),[D.SHOW]:te(Re("h"))},On=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],Ln=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],Mn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Rn=()=>{const n=(t,a)=>{switch(a){case t.up:Z(a,oe(()=>(ee.setMove(D.ARROW_UP),!1),50));break;case t.right:Z(a,oe(()=>(ee.setMove(D.ARROW_RIGHT),!1),50));break;case t.down:Z(a,oe(()=>(ee.setMove(D.ARROW_DOWN),!1),50));break;case t.left:Z(a,oe(()=>(ee.setMove(D.ARROW_LEFT),!1),50));break;case t.delete:Z(a,Ye(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(a,Ye(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(a,Ye(()=>(ee.setCut(),!1),50));break;case t.parse:Z(a,oe(()=>(ee.setParse(),!1),50));break;case t.back:Z(a,oe(()=>(ee.setBack(),!1),50));break;case t.forward:Z(a,oe(()=>(ee.setForward(),!1),50));break;case t.group:Z(a,oe(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(a,oe(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(a,oe(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(a,oe(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(a,oe(()=>(ee.setHide(),!1),50));break;case t.show:Z(a,oe(()=>(ee.setShow(),!1),50));break}};On.forEach(t=>{n(J,t)}),Ln.forEach(t=>{n(V,t)}),Mn()},w=re(),{onClickOutSide:Bn}=ut(),In=e=>we(void 0,null,function*(){e.preventDefault();try{Tn();const n=e.dataTransfer.getData(an.DRAG_KEY);if(!n){vt();return}w.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let a,o;if(t.sourceID){let d=yield Kt(t.sourceID,t.category);if(!d){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}a=d.chartConfig;const f=Yt(d.chartConfig);o=new f.default(d.chartConfig),o=De.exports.merge({},o,d),o.id=rn()}else o=yield Gt(t);q(o,e.offsetX-o.attr.w/2,e.offsetY-o.attr.h/2),w.addComponentList(o,!1,!0),w.setTargetSelectChart(o.id),vt()}catch(n){xn(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),gt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Lt=(e,n)=>{if(n){w.setTargetSelectChart(n.id);return}w.setTargetSelectChart(void 0)},Hn=(e,n)=>{var h;if(e.which==2||(h=window.$KeyboardActive)!=null&&h.space)return;Lt();const t=e.offsetX,a=e.offsetY,o=e.screenX,d=e.screenY,f=w.getEditCanvas.scale;w.setMousePosition(void 0,void 0,t,a);const y=De.exports.throttle(_=>{w.setTargetSelectChart(),w.setEditCanvas(ae.IS_SELECT,!0);const l=t+_.screenX-o,c=a+_.screenY-d;w.setMousePosition(l,c);const r={x1:0,y1:0,x2:0,y2:0};l>t&&c>a?(r.x1=t,r.y1=a,r.x2=Math.round(t+(_.screenX-o)/f),r.y2=Math.round(a+(_.screenY-d)/f)):l>t&&c<a?(r.x1=t,r.y1=Math.round(a-(d-_.screenY)/f),r.x2=Math.round(t+(_.screenX-o)/f),r.y2=a):l<t&&c>a?(r.x1=Math.round(t-(o-_.screenX)/f),r.y1=a,r.x2=t,r.y2=Math.round(a+(_.screenY-d)/f)):(r.x1=Math.round(t-(o-_.screenX)/f),r.y1=Math.round(a-(d-_.screenY)/f),r.x2=t,r.y2=a),w.getComponentList.forEach(p=>{if(!w.getTargetChart.selectId.includes(p.id)){const{x:g,y:C,w:S,h:b}=p.attr,M={x1:g,y1:C,x2:g+S,y2:C+b};M.x1-r.x1>=0&&M.y1-r.y1>=0&&M.x2-r.x2<=0&&M.y2-r.y2<=0&&!p.status.lock&&!p.status.hide&&w.setTargetSelectChart(p.id,!0)}})},30),m=()=>{y.cancel(),w.setEditCanvas(ae.IS_SELECT,!1),w.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",m)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",m)},Mt=()=>({mouseClickHandle:(o,d)=>{var f;if(o.preventDefault(),o.stopPropagation(),!d.status.lock&&(f=window.$KeyboardActive)!=null&&f.ctrl)if(w.targetChart.selectId.includes(d.id)){const y=w.targetChart.selectId.filter(m=>m!==d.id);w.setTargetSelectChart(y)}else w.setTargetSelectChart(d.id,!0)},mousedownHandle:(o,d)=>{var C;if(o.preventDefault(),o.stopPropagation(),d.status.lock||(Bn(),o.buttons===Ge.LEFT&&((C=window.$KeyboardActive)==null?void 0:C.ctrl)))return;const f=w.getTargetChart.selectId;if(o.buttons===Ge.RIGHT&&f.length>1&&f.includes(d.id)||(w.setTargetSelectChart(d.id),o.buttons===Ge.RIGHT))return;const y=w.getEditCanvas.scale,m=w.getEditCanvasConfig.width,h=w.getEditCanvasConfig.height,_=new Map;w.getTargetChart.selectId.forEach(S=>{const b=w.fetchTargetIndex(S);if(b!==-1){const{x:M,y:O,w:U,h:G}=un(w.getComponentList[b]).attr;_.set(S,{x:M,y:O,w:U,h:G})}});const l=o.screenX,c=o.screenY;let r=[];w.getTargetChart.selectId.forEach(S=>{if(!_.has(S))return;const b=w.fetchTargetIndex(S);r.push(De.exports.cloneDeep(w.getComponentList[b]))}),w.setMousePosition(void 0,void 0,l,c);const p=De.exports.throttle(S=>{w.setEditCanvas(ae.IS_DRAG,!0),w.setMousePosition(S.screenX,S.screenY);let b=(S.screenX-l)/y,M=(S.screenY-c)/y;w.getTargetChart.selectId.forEach(O=>{if(!_.has(O))return;const U=w.fetchTargetIndex(O),{x:G,y:W,w:E,h:v}=_.get(O),H=w.getComponentList[U];let K=Math.round(G+b),x=Math.round(W+M);const R=50;K=K<-E+R?-E+R:K,x=x<-v+R?-v+R:x,K=K>m-R?m-R:K,x=x>h-R?h-R:x,H&&!Number.isNaN(K)&&!Number.isNaN(x)&&(H.attr=Object.assign(H.attr,{x:K,y:x}))})},20),g=()=>{try{w.setMousePosition(0,0,0,0),w.setEditCanvas(ae.IS_DRAG,!1),r.length&&(w.getTargetChart.selectId.forEach(S=>{if(!_.has(S))return;const b=w.fetchTargetIndex(S),M=w.getComponentList[b];r.forEach(O=>{O.id===S&&(O.attr=Object.assign(O.attr,{offsetX:M.attr.x-O.attr.x,offsetY:M.attr.y-O.attr.y}))})}),w.moveComponentList(r)),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g)}catch(S){console.log(S)}};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)},mouseenterHandle:(o,d)=>{o.preventDefault(),o.stopPropagation(),w.getEditCanvas.isSelect||w.setTargetHoverChart(d.id)},mouseleaveHandle:(o,d)=>{o.preventDefault(),o.stopPropagation(),w.setEditCanvas(ae.IS_DRAG,!1),w.setTargetHoverChart(void 0)}}),Pn=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),w.setEditCanvas(ae.IS_DRAG,!0);const a=w.getEditCanvas.scale,o=t.x,d=t.y,f=t.w,y=t.h,m=t.lockScale,h=t.scaleRatio,_=t.minWidth,l=e.screenX,c=e.screenY,r=f-_;w.setMousePosition(l,c);const p=De.exports.throttle(C=>{w.setMousePosition(C.screenX,C.screenY);let S=Math.round((C.screenX-l)/a),b=Math.round((C.screenY-c)/a);const M=/t/.test(n),O=/b/.test(n),U=/l/.test(n),G=/r/.test(n);let W=y+(M?-b:O?b:0),E=f+(U?-S:G?S:0);m&&((M||O)&&(E=Math.round(W*h)),(U||G)&&(W=Math.round(E/h))),U&&(E<_&&r>0&&(S=r),r===0&&S>0&&(S=0)),t.h=W>0?W:0,t.w=E>0?E:0,t.x=o+(U?S:0),t.y=d+(M?b:0)},50),g=()=>{w.setEditCanvas(ae.IS_DRAG,!1),w.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)};const $n=["onMousedown"],Un=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const n=e;ke(l=>({"026d39a0":s(f)}));const t=Fe(),a=re(),o=["t","r","b","l","lt","rt","lb","rb"],d=["n","e","s","w","nw","ne","sw","se"],f=$(()=>t.getAppTheme),y=$(()=>n.item.status.lock?!1:n.item.id===a.getTargetChart.hoverId),m=$(()=>{const l=n.item.id;return n.item.status.lock?!1:a.getTargetChart.selectId.find(c=>c===l)}),h=$(()=>n.item.status.lock),_=$(()=>n.item.status.hide);return(l,c)=>(T(),j("div",{class:de(["go-shape-box",{lock:s(h),hide:s(_)}])},[at(l.$slots,"default",{},void 0,!0),e.hiddenPoint?ce("",!0):(T(!0),j(he,{key:0},_e(s(m)?o:[],(r,p)=>(T(),j("div",{class:de(`shape-point ${r}`),key:p,style:ne(s(Xt)(r,p,e.item.attr,d)),onMousedown:g=>s(Pn)(g,r,e.item.attr)},null,46,$n))),128)),z("div",{class:"shape-modal",style:ne(s(Ee)(e.item.attr))},[z("div",{class:de(["shape-modal-select",{active:s(m)}])},null,2),z("div",{class:de(["shape-modal-change",{selectActive:s(m),hoverActive:s(y)}])},null,2)],4)],2))}});var et=le(Un,[["__scopeId","data-v-5f8854aa"]]);const Nn={class:"go-edit-group-box"},Kn=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ut(),{mouseenterHandle:a,mouseleaveHandle:o,mousedownHandle:d,mouseClickHandle:f}=Mt(),y=(_,l,c)=>{const r=p=>l.filter(g=>p.includes(g.key));if(n.getTargetChart.selectId.length>1)return r([D.GROUP,D.DELETE]);{const p=[];c.status.lock?p.push(D.LOCK):p.push(D.UNLOCK),c.status.hide?p.push(D.HIDE):p.push(D.SHOW);const g=[D.UN_GROUP];return[...r(g),wn(),..._.filter(C=>!p.includes(C.key))]}},m=$(()=>{const _=n.getEditCanvasConfig.chartThemeColor;return St[_]}),h=$(()=>n.getEditCanvasConfig.chartThemeSetting);return(_,l)=>(T(),j("div",Nn,[(T(),P(s(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:de(s(Qe)(e.groupData.styles.animations)),style:ne(Y(Y(Y(Y(Y({},s(Ie)(e.groupData.attr,e.groupIndex)),s(Ee)(e.groupData.attr)),s(He)(e.groupData.styles)),s(Ze)(e.groupData.styles)),s(At)(e.groupData.styles))),onClick:l[0]||(l[0]=c=>s(f)(c,e.groupData)),onMousedown:l[1]||(l[1]=c=>s(d)(c,e.groupData)),onMouseenter:l[2]||(l[2]=c=>s(a)(c,e.groupData)),onMouseleave:l[3]||(l[3]=c=>s(o)(c,e.groupData)),onContextmenu:l[4]||(l[4]=c=>s(t)(c,e.groupData,y))},{default:A(()=>[(T(!0),j(he,null,_e(e.groupData.groupList,c=>(T(),P(s(et),{key:c.id,"data-id":c.id,index:e.groupIndex,item:c,hiddenPoint:!0,style:ne(Y({},s(Ie)(c.attr,e.groupIndex)))},{default:A(()=>[(T(),P(Ce(c.chartConfig.chartKey),{class:de(["edit-content-chart",s(Qe)(c.styles.animations)]),chartConfig:c,themeSetting:s(h),themeColor:s(m),style:ne(Y(Y(Y({},s(Ee)(c.attr)),s(He)(c.styles)),s(Ze)(c.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Yn={class:"go-edit-align-line"},Gn=ue({__name:"index",setup(e){ke(p=>({"32d4d33a":s(f)}));const n=Fe(),t=re(),a=rt(),o=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),d=p=>p?{left:`${p.x?p.x:0}px`,top:`${p.y?p.y:0}px`}:{},f=$(()=>n.getAppTheme),y=$(()=>a.getChartAlignRange),m=$(()=>t.getEditCanvas[ae.IS_DRAG]),h=(p,g)=>Math.abs(p-g)<=y.value,_=$(()=>t.getTargetChart.selectId),l=$(()=>t.getComponentList[t.fetchTargetIndex()]),c=$(()=>{var p;return((p=l.value)==null?void 0:p.attr)||{}}),r=$(()=>({id:"0",attr:{w:ft(t.getEditCanvasConfig.width),h:ft(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0,scaleRatio:1.5,lockScale:!1,disabledHeight:!1,minWidth:50}}));return pe(()=>t.getMousePosition,oe(()=>{try{if(!m.value||_.value.length!==1)return;const p=c.value.w,g=c.value.h,C=c.value.x,S=C+p/2,b=C+p,M=[C,S,b],O=c.value.y,U=O+g/2,G=O+g,W=[O,U,G];o.select.clear(),o.sorptioned.y=!1;const E=t.getComponentList.map(v=>({id:v.id,attr:v.attr}));E.push(r.value),o.lineArr.forEach(v=>{E.forEach(H=>{if(_.value[0]===H.id)return;const K=H.attr.w,x=H.attr.h,R=H.attr.x,u=R+K/2,i=R+K,k=[R,u,i],F=H.attr.y,X=F+x/2,N=F+x,ie=[F,X,N];v.includes("rowt")&&(h(O,F)&&(o.select.set(v,{y:F}),q(l.value,C,F)),h(O,X)&&(o.select.set(v,{y:X}),q(l.value,C,X)),h(O,N)&&(o.select.set(v,{y:N}),q(l.value,C,N))),v.includes("rowc")&&(h(U,F)&&(o.select.set(v,{y:F}),q(l.value,C,F-g/2)),h(U,X)&&(o.select.set(v,{y:X}),q(l.value,C,X-g/2)),h(U,N)&&(o.select.set(v,{y:N}),q(l.value,C,N-g/2))),v.includes("rowb")&&(h(G,F)&&(o.select.set(v,{y:F}),q(l.value,C,F-g)),h(G,X)&&(o.select.set(v,{y:X}),q(l.value,C,X-g)),h(G,N)&&(o.select.set(v,{y:N}),q(l.value,C,N-g))),v.includes("coll")&&(h(C,R)&&(o.select.set(v,{x:R}),q(l.value,R,O)),h(C,u)&&(o.select.set(v,{x:u}),q(l.value,u,O)),h(C,i)&&(o.select.set(v,{x:i}),q(l.value,i,O))),v.includes("colc")&&(h(S,R)&&(o.select.set(v,{x:R}),q(l.value,R-p/2,O)),h(S,u)&&(o.select.set(v,{x:u}),q(l.value,u-p/2,O)),h(S,i)&&(o.select.set(v,{x:i}),q(l.value,i-p/2,O))),v.includes("colr")&&(h(b,R)&&(o.select.set(v,{x:R}),q(l.value,R-p,O)),h(b,u)&&(o.select.set(v,{x:u}),q(l.value,u-p,O)),h(b,i)&&(o.select.set(v,{x:i}),q(l.value,i-p,O)))})})}catch(p){console.log(p)}},200),{deep:!0}),pe(()=>m.value,p=>{p||(o.select.clear(),o.sorptioned.y=!1)}),(p,g)=>(T(),j("div",Yn,[(T(!0),j(he,null,_e(o.lineArr,C=>(T(),j("div",{class:de(["line",[C.includes("row")?"row":"col",o.select.has(C)&&"visible"]]),key:C,style:ne(d(o.select.get(C)))},null,6))),128))]))}});var Xn=le(Gn,[["__scopeId","data-v-41123ead"]]);const Wn=ue({__name:"index",setup(e){return(n,t)=>{const a=I("n-watermark");return T(),P(a,{id:"go-edit-watermark",content:s(cn),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var zn=le(Wn,[["__scopeId","data-v-e5cd93da"]]);const Rt=e=>(kt("data-v-6aae2e54"),e=e(),Ft(),e),jn=Rt(()=>z("div",{class:"select-background"},null,-1)),qn=Rt(()=>z("div",{class:"select-border"},null,-1)),Jn=[jn,qn],Vn=ue({__name:"index",setup(e){ke(y=>({bb49f51e:s(d)}));const n=Fe(),t=re(),{isSelect:a,scale:o}=Ue(t.getEditCanvas),d=$(()=>n.getAppTheme),f=Q();return pe(()=>t.getMousePosition,y=>{if(!a.value)return;const{startX:m,startY:h,x:_,y:l}=y,c={zIndex:pt,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0,lockScale:!1,scaleRatio:1.5,disabledHeight:!1,minWidth:50};_>m&&l>h?(c.x=m,c.y=h,c.w=Math.round((_-m)/o.value),c.h=Math.round((l-h)/o.value)):_>m&&l<h?(c.x=m,c.w=Math.round((_-m)/o.value),c.h=Math.round((h-l)/o.value),c.y=h-c.h):_<m&&l>h?(c.y=h,c.w=Math.round((m-_)/o.value),c.h=Math.round((l-h)/o.value),c.x=m-c.w):(c.w=Math.round((m-_)/o.value),c.h=Math.round((h-l)/o.value),c.x=m-c.w,c.y=h-c.h),f.value=Y(Y({},Ie(c,pt)),Ee(c))},{deep:!0}),(y,m)=>s(a)?(T(),j("div",{key:0,class:"go-edit-select",style:ne(f.value)},Jn,4)):ce("",!0)}});var Qn=le(Vn,[["__scopeId","data-v-6aae2e54"]]);const Zn=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:a}=Ue(n),o=$(()=>({w:t.value.width,h:t.value.height})),d=$(()=>{const y={transform:`scale(${a.value.scale})`};return Y(Y({},Ee(o.value)),y)}),f=$(()=>{const y=a.value.isCreate&&{"z-index":99999};return Y(Y({},Ee(o.value)),y)});return(y,m)=>(T(),j("div",{class:"go-edit-range go-transition",style:ne(s(d)),onMousedown:m[0]||(m[0]=h=>s(Hn)(h,void 0))},[at(y.$slots,"default",{},void 0,!0),L(s(zn)),L(s(Xn)),L(s(Qn)),z("div",{class:"go-edit-range-model",style:ne(s(f))},null,4)],36))}});var es=le(Zn,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var qe={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",qe,qe),window.removeEventListener("test",qe,!0))}catch(e){}function ts(e,n,t,a){if(a&&typeof a!="boolean"&&!nt){var o=a.once,d=a.capture,f=t;!nt&&o&&(f=t.__once||function y(m){this.removeEventListener(n,y,d),t.call(this,m)},t.__once=f),e.addEventListener(n,f,tt?a:d)}e.addEventListener(n,t,a)}function ns(e,n,t,a){var o=a&&typeof a!="boolean"?a.capture:a;e.removeEventListener(n,t,o),t.__once&&e.removeEventListener(n,t.__once,o)}function _t(e,n,t,a){return ts(e,n,t,a),function(){ns(e,n,t,a)}}var mt=new Date().getTime();function ss(e){var n=new Date().getTime(),t=Math.max(0,16-(n-mt)),a=setTimeout(e,t);return mt=n,a}var os=["","webkit","moz","o","ms"],Ct=ss,yt=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&os.some(function(e){var n=yt(e,"request");return n in window&&(yt(e,"cancel"),Ct=function(a){return window[n](a)}),!!Ct});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const as={class:"go-sketch-rule"},rs={key:1,class:"fix-edit-screens-block"},us=ue({__name:"index",setup(e){ke(x=>({"6f694401":s(U),ed8dd9a8:s(M),"58b617f4":c.value}));const n=re(),t=Wt(),a=Fe(),o=20;let d=[0,0],f=[0,0];const y=Q(),m=Q(!0),h=Q(),_=Q(),l=Q(!1),c=Q("auto"),{width:r,height:p}=Ue(n.getEditCanvasConfig),g=Q(0),C=Q(0),S=$e({h:[],v:[]}),b=$(()=>n.getEditCanvas.scale),M=$(()=>`${p.value*2}px`),O=$(()=>a.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),U=$(()=>a.getAppTheme),G=x=>{if(x.ctrlKey||x.metaKey){x.preventDefault();let R=b.value;if(x.wheelDelta>=0&&b.value<2){R=b.value+.05,n.setScale(R);return}x.wheelDelta<0&&b.value>.1&&(R=b.value-.05,n.setScale(R))}},W=()=>{if(!y.value)return;const x=y.value.getBoundingClientRect(),R=h.value.getBoundingClientRect();g.value=(x.left+o-R.left)/b.value,C.value=(x.top+o-R.top)/b.value},E=x=>{var F,X;if(x.preventDefault(),x.stopPropagation(),x.which==2)l.value=!0;else if(!((F=window.$KeyboardActive)!=null&&F.space))return;(X=document.activeElement)==null||X.blur();const R=x.pageX,u=x.pageY,i=_t(window,"mousemove",N=>{const ie=N.pageX-R,Se=N.pageY-u,[Ne,be]=d,[Ke,Oe]=f;d=[be,ie],f=[Oe,Se],y.value.scrollLeft-=be>Ne?Math.abs(be-Ne):-Math.abs(be-Ne),y.value.scrollTop-=Oe>Ke?Math.abs(Oe-Ke):-Math.abs(Oe-Ke)}),k=_t(window,"mouseup",()=>{i(),k(),d=[0,0],f=[0,0],l.value=!1})},v=()=>{const x=document.getElementById("go-chart-edit-layout");return x?{height:x.clientHeight-25,width:x.clientWidth}:{width:r.value,height:p.value}},H=()=>{m.value=!1,setTimeout(()=>{m.value=!0},10)},K=()=>{const{width:x,height:R}=_.value.getBoundingClientRect(),{width:u,height:i}=v();y.value.scrollLeft=x/2-u/2,y.value.scrollTop=R/2-i/2};return pe(()=>a.getDarkTheme,()=>{H()}),pe(()=>b.value,(x,R)=>{R!==x?(t.setItemUnHandle(zt.RE_POSITION_CANVAS,!1),W(),setTimeout(()=>{K(),H()},400)):oe(H,20)}),pe(()=>l.value,x=>{c.value=x?"grab":"auto"}),ot(()=>{y.value&&(y.value.addEventListener("wheel",G,{passive:!1}),K())}),Tt(()=>{y.value&&y.value.removeEventListener("wheel",G)}),window.onKeySpacePressHold=x=>{l.value=x},(x,R)=>{const u=I("sketch-rule");return T(),j("div",as,[m.value?(T(),P(u,{key:0,thick:o,scale:s(b),width:v().width,height:v().height,startX:g.value,startY:C.value,lines:S,palette:s(O)},null,8,["scale","width","height","startX","startY","lines","palette"])):ce("",!0),z("div",{ref_key:"$app",ref:y,class:"edit-screens",onScroll:W},[z("div",{ref_key:"$container",ref:_,class:"edit-screen-container",style:ne({width:s(r)*2+"px"})},[z("div",{ref_key:"refSketchRuleBox",ref:h,class:"canvas",onMousedown:E,style:ne({marginLeft:"-"+(v().width/2-25)+"px"})},[z("div",{style:ne({pointerEvents:l.value?"none":"auto"})},[at(x.$slots,"default",{},void 0,!0)],4)],36)],4)],544),s(a).getDarkTheme?(T(),j("div",rs)):ce("",!0)])}}});var cs=le(us,[["__scopeId","data-v-12b70182"]]);const Je={[B.ADD]:"\u65B0\u589E",[B.DELETE]:"\u5220\u9664",[B.UPDATE]:"\u66F4\u65B0",[B.MOVE]:"\u79FB\u52A8",[B.PASTE]:"\u7C98\u8D34",[B.COPY]:"\u590D\u5236",[B.CUT]:"\u526A\u5207",[B.TOP]:"\u7F6E\u9876",[B.BOTTOM]:"\u7F6E\u5E95",[B.UP]:"\u4E0A\u79FB",[B.DOWN]:"\u4E0B\u79FB",[B.GROUP]:"\u6210\u7EC4",[B.UN_GROUP]:"\u89E3\u7EC4",[B.LOCK]:"\u9501\u5B9A",[B.UNLOCK]:"\u89E3\u9501",[B.HIDE]:"\u9690\u85CF",[B.SHOW]:"\u663E\u793A",[Be.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var ls=Array.prototype,is=ls.reverse;function ds(e){return e==null?e:is.call(e)}var fs=ds;const It=e=>(kt("data-v-5a4fd660"),e=e(),Ft(),e),ps={class:"go-flex-items-center"},hs=It(()=>z("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),vs={class:"history-list-box"},gs=["title"],_s=It(()=>z("div",{class:"popover-modal"},null,-1)),ms=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:a,CopyIcon:o,LayersIcon:d,DuplicateIcon:f,HelpOutlineIcon:y,LockClosedOutlineIcon:m,LockOpenOutlineIcon:h,EyeOffOutlineIcon:_,EyeOutlineIcon:l}=Ae.ionicons5,{StackedMoveIcon:c,Carbon3DCursorIcon:r,Carbon3DSoftwareIcon:p}=Ae.carbon,g=jt(),C=M=>{if(M.targetType===Be.CANVAS)return n;switch(M.actionType){case B.UPDATE:return t;case B.DELETE:return a;case B.PASTE:return o;case B.TOP:return d;case B.BOTTOM:return d;case B.UP:return d;case B.DOWN:return d;case B.MOVE:return c;case B.ADD:return f;case B.GROUP:return r;case B.UN_GROUP:return p;case B.LOCK:return m;case B.UNLOCK:return h;case B.HIDE:return _;case B.SHOW:return l;default:return t}},S=M=>{if(M.targetType===Be.CANVAS)return Je[Be.CANVAS];if(M.actionType===B.GROUP||M.actionType===B.UN_GROUP)return`${Je[M.actionType]}`;if(M.historyData.length)return`${Je[M.actionType]} - ${M.historyData[0].chartConfig.title}`},b=$(()=>{const O=g.getBackStack.map(U=>({label:S(U),icon:C(U)}));return fs(O.filter(U=>U.label))});return(M,O)=>{const U=I("n-button"),G=I("n-icon"),W=I("n-text"),E=I("n-scrollbar"),v=I("n-popover"),H=I("n-tooltip");return T(),j("div",ps,[L(v,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:A(()=>[L(U,{class:"mr-10",secondary:"",size:"small",disabled:s(b).length===0},{default:A(()=>[hs]),_:1},8,["disabled"])]),default:A(()=>[z("div",vs,[L(E,{style:{"max-height":"500px"}},{default:A(()=>[(T(!0),j(he,null,_e(s(b),(K,x)=>(T(),j("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:x,title:K.label},[L(G,{class:"item-icon",size:"16",depth:2,component:K.icon},null,8,["component"]),L(W,{depth:"2"},{default:A(()=>[ye(fe(K.label),1)]),_:2},1024)],8,gs))),128))]),_:1}),_s])]),_:1}),L(H,{trigger:"hover"},{trigger:A(()=>[L(G,{size:"21",depth:3},{default:A(()=>[L(s(y))]),_:1})]),default:A(()=>[z("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+fe(s(ln))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var Cs=le(ms,[["__scopeId","data-v-5a4fd660"]]);const ys={class:"go-edit-bottom"},Es=ue({__name:"index",setup(e){ke(C=>({f3add9fc:o.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=Ae.ionicons5,a=Fe(),o=Q(a.getAppTheme),d=re(),{lockScale:f,scale:y}=Ue(d.getEditCanvas);let m=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const h=Q(""),_=C=>{if(C===0){d.computedScale();return}d.setScale(C/100)},l=()=>{d.setEditCanvas(ae.LOCK_SCALE,!f.value)},c=Q(100),r=C=>`${C}%`,p=C=>{d.setScale(C/100)},g=$e({100:""});return dn(()=>{const C=(y.value*100).toFixed(0);h.value=`${C}%`,c.value=parseInt(C)}),(C,S)=>{const b=I("n-text"),M=I("n-space"),O=I("n-select"),U=I("n-icon"),G=I("n-button"),W=I("n-tooltip"),E=I("n-slider");return T(),j("div",ys,[L(M,null,{default:A(()=>[L(s(Cs)),L(b,{id:"keyboard-dress-show",depth:"3"})]),_:1}),L(M,{class:"bottom-ri"},{default:A(()=>[L(kn),L(O,{disabled:s(f),class:"scale-btn",value:h.value,"onUpdate:value":[S[0]||(S[0]=v=>h.value=v),_],size:"mini",options:s(m)},null,8,["disabled","value","options"]),L(W,{trigger:"hover"},{trigger:A(()=>[L(G,{onClick:l,text:""},{default:A(()=>[L(U,{class:de(["lock-icon",{color:s(f)}]),size:"18",depth:2},{default:A(()=>[s(f)?(T(),P(s(n),{key:0})):(T(),P(s(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:A(()=>[z("span",null,fe(s(f)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),L(E,{class:"scale-slider",value:c.value,"onUpdate:value":[S[1]||(S[1]=v=>c.value=v),p],"default-value":50,min:10,max:200,step:5,"format-tooltip":r,disabled:s(f),marks:g},null,8,["value","disabled","marks"])]),_:1})])}}});var Ss=le(Es,[["__scopeId","data-v-99a534fc"]]);const ws=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,{HelpOutlineIcon:a,CloseIcon:o}=Ae.ionicons5,d=rt(),f=Q(!1),y=$e([{key:ve.ASIDE_ALL_COLLAPSED,value:d.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ve.HIDE_PACKAGE_ONE_CATEGORY,value:d.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ve.CHANGE_LANG_RELOAD,value:d.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_TOOLS_STATUS_HIDE,value:d.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ve.CHART_TOOLS_STATUS,value:d.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_MOVE_DISTANCE,value:d.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ve.CHART_ALIGN_RANGE,value:d.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);pe(()=>t.modelShow,_=>{f.value=_});const m=()=>{n("update:modelShow",!1)},h=(_,l)=>{d.setItem(l.key,l.value)};return(_,l)=>{const c=I("n-h3"),r=I("n-icon"),p=I("n-space"),g=I("n-divider"),C=I("n-text"),S=I("n-switch"),b=I("n-input-number"),M=I("n-select"),O=I("n-tooltip"),U=I("n-list-item"),G=I("n-list"),W=I("n-modal");return T(),P(W,{show:f.value,"onUpdate:show":l[0]||(l[0]=E=>f.value=E),onAfterLeave:m},{default:A(()=>[L(G,{bordered:"",class:"go-system-setting"},{header:A(()=>[L(p,{justify:"space-between"},{default:A(()=>[L(c,{class:"go-mb-0"},{default:A(()=>[ye("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),L(r,{size:"20",class:"go-cursor-pointer",onClick:m},{default:A(()=>[L(s(o))]),_:1})]),_:1})]),default:A(()=>[(T(!0),j(he,null,_e(y,E=>(T(),P(U,{key:E.key},{default:A(()=>[E.type==="divider"?(T(),P(g,{key:0,style:{margin:"0"}})):(T(),P(p,{key:1,size:40},{default:A(()=>[L(p,null,{default:A(()=>[L(C,{class:"item-left"},{default:A(()=>[ye(fe(E.name),1)]),_:2},1024),E.type==="switch"?(T(),P(S,{key:0,value:E.value,"onUpdate:value":[v=>E.value=v,v=>h(v,E)],size:"small"},null,8,["value","onUpdate:value"])):E.type==="number"?(T(),P(b,{key:1,value:E.value,"onUpdate:value":[v=>E.value=v,v=>h(v,E)],class:"input-num-width",size:"small",step:E.step||null,suffix:E.suffix||null,min:E.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):E.type==="select"?(T(),P(M,{key:2,class:"select-min-width",value:E.value,"onUpdate:value":[v=>E.value=v,v=>h(v,E)],size:"small",options:E.options},null,8,["value","onUpdate:value","options"])):ce("",!0)]),_:2},1024),L(p,null,{default:A(()=>[L(C,{class:"item-right"},{default:A(()=>[ye(fe(E.desc),1)]),_:2},1024),E.tip?(T(),P(O,{key:0,trigger:"hover"},{trigger:A(()=>[L(r,{size:"21"},{default:A(()=>[L(s(a))]),_:1})]),default:A(()=>[z("span",null,fe(E.tip),1)]),_:2},1024)):ce("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var Ts=le(ws,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),xs=()=>{xe.setTargetSelectChart(void 0),fn(pn(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{hn(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var st=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(st||{});const Ds=()=>{const e=Q(),{updateComponent:n}=wt();return{importUploadFileListRef:e,importBeforeUpload:({file:o})=>{e.value=[];const d=o.file.type;return d!==st.JSON&&d!==st.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:o=>{const{file:d}=o;vn(()=>{d.file?gn(d.file).then(f=>{Dn({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>we(void 0,null,function*(){try{f=Ve(f),yield n(f,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>we(void 0,null,function*(){try{f=Ve(f),yield n(f,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:As,dataSyncUpdate:Et}=wt(),ks=re(),Fs=()=>{const e=d=>As(d.detail,!0,!1),n=()=>we(void 0,null,function*(){Et&&(yield Et()),dispatchEvent(new CustomEvent(Xe.CHART,{detail:ks.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Xe.JSON,e)},a=()=>{removeEventListener(Xe.JSON,e),removeEventListener("blur",n)};return(d,f)=>{f==ht.CHART_HOME_NAME&&a(),d==ht.CHART_HOME_NAME&&t()}},bs=()=>{const e=bt();pe(()=>e.name,Fs(),{immediate:!0})};var ge=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(ge||{});const Os={class:"btn-item"},Ls=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:a,SettingsSharpIcon:o,CreateIcon:d}=Ae.ionicons5,f=rt(),y=re();bt(),bs();let m=null;const h=Q(!1),_=Q(!0),l=Q(!0),{importUploadFileListRef:c,importCustomRequest:r,importBeforeUpload:p}=Ds(),g=$(()=>f.getChartToolsStatus===Pe.ASIDE),C=$(()=>f.getChartToolsStatusHide),S=$(()=>_.value&&C.value),b=$(()=>{if(!g.value)return W;const E=[];return W.map(v=>{E.unshift(v)}),E}),M=()=>{m=setTimeout(()=>{_.value&&(_.value=!1,l.value=!0)},200),setTimeout(()=>{l.value=!1},400)},O=()=>{clearTimeout(m),_.value||(_.value=!0)},U=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const E=mn(Cn.CHART_EDIT_NAME,"href");if(!E)return;const v=yn();G(v),En(E,[v],void 0,!0)},1e3)},G=E=>{const v=y.getStorageInfo,H=Sn(Le.GO_CHART_STORAGE_LIST)||[];if(H!=null&&H.length){const K=H.findIndex(x=>x.id===E);K!==-1?(H.splice(K,1,me(Y({},v),{id:E})),je(Le.GO_CHART_STORAGE_LIST,H)):(H.push(me(Y({},v),{id:E})),je(Le.GO_CHART_STORAGE_LIST,H))}else je(Le.GO_CHART_STORAGE_LIST,[me(Y({},v),{id:E})])},W=[{key:"import",type:ge.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:ge.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:xs},{key:"edit",type:ge.BUTTON,name:"\u7F16\u8F91",icon:d,handle:U},{key:"setting",type:ge.BUTTON,name:"\u8BBE\u7F6E",icon:o,handle:()=>{h.value=!0}}];return(E,v)=>{const H=I("n-icon"),K=I("n-text"),x=I("n-button"),R=I("n-upload"),u=I("n-tooltip");return T(),j(he,null,[z("div",{class:de(["go-chart-edit-tools",[s(f).getChartToolsStatus,s(S)?"isMini":"unMini"]]),onClick:v[1]||(v[1]=i=>_.value&&(_.value=!1)),onMouseenter:M,onMouseleave:O},[We(L(H,{class:"asideLogo",size:"22"},{default:A(()=>[L(s(a))]),_:1},512),[[ze,s(f).getChartToolsStatus===s(Pe).ASIDE&&s(S)]]),(T(!0),j(he,null,_e(s(b),(i,k)=>(T(),P(u,{key:i.key,disabled:!s(g)||s(C)&&l.value,trigger:"hover",placement:"left"},{trigger:A(()=>[z("div",Os,[i.type===s(ge).BUTTON?(T(),P(x,{key:0,circle:s(g),secondary:"",onClick:i.handle},{icon:A(()=>[s(g)?(T(),P(H,{key:0,size:"22"},{default:A(()=>[(T(),P(Ce(i.icon)))]),_:2},1024)):(T(),P(Ce(i.icon),{key:1}))]),default:A(()=>[We(L(K,{depth:"3"},{default:A(()=>[ye(fe(i.name),1)]),_:2},1536),[[ze,!s(g)]])]),_:2},1032,["circle","onClick"])):i.type===s(ge).IMPORTUPLOAD?(T(),P(R,{key:1,"file-list":s(c),"onUpdate:fileList":v[0]||(v[0]=F=>_n(c)?c.value=F:null),"show-file-list":!1,customRequest:s(r),onBeforeUpload:s(p)},{default:A(()=>[L(x,{circle:s(g),secondary:""},{icon:A(()=>[s(g)?(T(),P(H,{key:0,size:"22"},{default:A(()=>[(T(),P(Ce(i.icon)))]),_:2},1024)):(T(),P(Ce(i.icon),{key:1}))]),default:A(()=>[We(L(K,{depth:"3"},{default:A(()=>[ye(fe(i.name),1)]),_:2},1536),[[ze,!s(g)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):ce("",!0)])]),default:A(()=>[z("span",null,fe(i.name),1)]),_:2},1032,["disabled"]))),128))],34),L(s(Ts),{modelShow:h.value,"onUpdate:modelShow":v[2]||(v[2]=i=>h.value=i)},null,8,["modelShow"])],64)}}});var Ms=le(Ls,[["__scopeId","data-v-4c257f27"]]);const Rs=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ut();bn();const{mouseenterHandle:a,mouseleaveHandle:o,mousedownHandle:d,mouseClickHandle:f}=Mt(),y=(l,c,r)=>{if(n.getTargetChart.selectId.length>1)return c.filter(g=>[D.GROUP,D.DELETE].includes(g.key));const p=[];return r.status.lock?p.push(D.LOCK):p.push(D.UNLOCK),r.status.hide?p.push(D.HIDE):p.push(D.SHOW),l.filter(g=>!p.includes(g.key))},m=$(()=>n.getEditCanvasConfig.chartThemeSetting),h=$(()=>{const l=n.getEditCanvasConfig.chartThemeColor;return St[l]});$(()=>n.getEditCanvasConfig.filterShow);const _=$(()=>{const l=n.getEditCanvasConfig.background,c=n.getEditCanvasConfig.backgroundImage,g=n.getEditCanvasConfig.selectColor?{background:l||void 0}:{background:`url(${c}) no-repeat center center / cover !important`};return me(Y({},g),{width:"inherit",height:"inherit"})});return ot(()=>{Rn()}),(l,c)=>(T(),P(s(An),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:s(Lt),onDrop:s(In),onDragover:s(gt),onDragenter:s(gt)},{aside:A(()=>[L(s(Ms))]),bottom:A(()=>[L(s(Ss))]),default:A(()=>[L(s(cs),null,{default:A(()=>[z("div",{id:"go-chart-edit-content",onContextmenu:c[0]||(c[0]=(...r)=>s(t)&&s(t)(...r))},[L(s(es),null,{default:A(()=>[z("div",{style:ne(Y(Y({},s(He)(s(n).getEditCanvasConfig)),s(_)))},[(T(!0),j(he,null,_e(s(n).getComponentList,(r,p)=>(T(),j("div",{key:r.id},[r.isGroup?(T(),P(s(Kn),{key:0,groupData:r,groupIndex:p},null,8,["groupData","groupIndex"])):(T(),P(s(et),{key:1,"data-id":r.id,index:p,style:ne(Y(Y({},s(Ie)(r.attr,p)),s(At)(r.styles))),item:r,onClick:g=>s(f)(g,r),onMousedown:g=>s(d)(g,r),onMouseenter:g=>s(a)(g,r),onMouseleave:g=>s(o)(g,r),onContextmenu:g=>s(t)(g,r,y)},{default:A(()=>{var g,C,S,b;return[s(qt)(r)&&!((g=r.option)!=null&&g.isDeleted)?(T(),P(s(Jt),{key:0,title:s(Vt)(r),attr:r.attr,titleSize:s(Qt)(r),titleStyle:s(Zt)(r)},null,8,["title","attr","titleSize","titleStyle"])):ce("",!0),s(en)(r)&&!((C=r.option)!=null&&C.isDeleted)?(T(),P(s(tn),{key:1,class:"filter-content",componentIdx:r.id,attr:r.attr,filters:r.chartConfig.filters,type:r.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):ce("",!0),(S=r.option)!=null&&S.isDeleted?(T(),P(s(Fn),{key:2,item:r,style:ne(me(Y({},s(it)(r.attr,0)),{lineHeight:r.attr.h+"px"}))},null,8,["item","style"])):ce("",!0),(b=r.option)!=null&&b.isDeleted?ce("",!0):(T(),P(Ce(r.chartConfig.chartKey),{key:3,class:de(["edit-content-chart",s(Qe)(r.styles.animations)]),chartConfig:r,themeSetting:s(m),themeColor:s(h),style:ne(Y(Y(Y({},s(it)(r.attr,s(nn)(r)+s(sn)(r))),s(He)(r.styles)),s(Ze)(r.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]}),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var zs=le(Rs,[["__scopeId","data-v-f20efb74"]]);export{zs as default};

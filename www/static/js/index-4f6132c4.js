var Pt=Object.defineProperty,$t=Object.defineProperties;var Ut=Object.getOwnPropertyDescriptors;var ct=Object.getOwnPropertySymbols;var Nt=Object.prototype.hasOwnProperty,Kt=Object.prototype.propertyIsEnumerable;var lt=(e,n,t)=>n in e?Pt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,K=(e,n)=>{for(var t in n||(n={}))Nt.call(n,t)&&lt(e,t,n[t]);if(ct)for(var t of ct(n))Kt.call(n,t)&&lt(e,t,n[t]);return e},me=(e,n)=>$t(e,Ut(n));var we=(e,n,t)=>new Promise((r,o)=>{var d=_=>{try{y(t.next(_))}catch(h){o(h)}},f=_=>{try{y(t.throw(_))}catch(h){o(h)}},y=_=>_.done?r(_.value):Promise.resolve(_.value).then(d,f);y((t=t.apply(e,n)).next())});import{u as re,r as ae,t as oe,y as Ye,z as Yt,A as Gt,B as De,x as Xt,D as Wt,G as Ee,c as St,H as Ie,k as zt,C as jt,I as R,J as Be,a as qt,b as wt,i as Jt,O as Vt,g as Qt,d as Zt,e as en,h as tn,F as nn,K as it,o as sn,f as on}from"./useSync.hook-5a69886b.js";import{x as ot,a6 as Tt,aJ as an,ah as D,c8 as xt,c9 as Dt,co as dt,cn as rn,c5 as Ve,U as un,cp as q,cd as Ge,ai as cn,j as ie,d as ue,bL as ke,f as s,u as Fe,a5 as H,o as x,m as j,n as at,F as he,A as _e,ad as de,aR as ne,aa as le,z,c as P,w as A,L as Ce,bW as Qe,bX as He,bY as Ze,bZ as At,a4 as rt,y as $e,aj as ft,R as fe,r as I,cq as ln,a3 as Ue,v as Q,cr as pt,G as kt,H as Ft,e as M,p as ye,t as pe,aI as dn,aU as fn,cs as ve,ct as Pe,cu as pn,c4 as hn,cv as vn,ak as gn,cw as _n,J as bt,Q as ht,c1 as Xe,X as We,Y as ze,aY as mn,V as Cn,cx as yn,cy as En,W as Sn,aP as wn,S as Le,c2 as je}from"./index.js";import{u as ut,d as Tn}from"./index-531b1eec.js";import{a as xn,b as vt,l as Dn,g as An}from"./plugin-5e32ea78.js";import{C as kn}from"./index-8a090643.js";import{i as Ae}from"./icon-7a385d7b.js";import{E as Fn}from"./index-413c73d5.js";import{N as bn}from"./NotFoundComponent-366532de.js";import"./tables_list-553e31dd.js";import"./index-9419c06f.js";import"./index-4cb606a5.js";const Te=re(),On=()=>{ot(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();Tt(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var Ot={exports:{}};(function(e){(function(n){var t,r={},o={16:!1,18:!1,17:!1,91:!1},d="all",f={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},y={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},_=function(a){return y[a]||a.toUpperCase().charCodeAt(0)},h=[];for(t=1;t<20;t++)y["f"+t]=111+t;function m(a,i){for(var k=a.length;k--;)if(a[k]===i)return k;return-1}function l(a,i){if(a.length!=i.length)return!1;for(var k=0;k<a.length;k++)if(a[k]!==i[k])return!1;return!0}var c={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function u(a){for(t in o)o[t]=a[c[t]]}function p(a){var i,k,F,Y,N,ce;if(i=a.keyCode,m(h,i)==-1&&h.push(i),(i==93||i==224)&&(i=91),i in o){o[i]=!0;for(F in f)f[F]==i&&(w[F]=!0);return}if(u(a),!!w.filter.call(this,a)&&i in r){for(ce=W(),Y=0;Y<r[i].length;Y++)if(k=r[i][Y],k.scope==ce||k.scope=="all"){N=k.mods.length>0;for(F in o)(!o[F]&&m(k.mods,+F)>-1||o[F]&&m(k.mods,+F)==-1)&&(N=!1);(k.mods.length==0&&!o[16]&&!o[18]&&!o[17]&&!o[91]||N)&&k.method(a,k)===!1&&(a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation&&a.stopPropagation(),a.cancelBubble&&(a.cancelBubble=!0))}}}function g(a){var i=a.keyCode,k,F=m(h,i);if(F>=0&&h.splice(F,1),(i==93||i==224)&&(i=91),i in o){o[i]=!1;for(k in f)f[k]==i&&(w[k]=!1)}}function C(){for(t in o)o[t]=!1;for(t in f)w[t]=!1}function w(a,i,k){var F,Y;F=v(a),k===void 0&&(k=i,i="all");for(var N=0;N<F.length;N++)Y=[],a=F[N].split("+"),a.length>1&&(Y=B(a),a=[a[a.length-1]]),a=a[0],a=_(a),a in r||(r[a]=[]),r[a].push({shortcut:F[N],scope:i,method:k,key:F[N],mods:Y})}function O(a,i){var k,F,Y=[],N,ce,Se;for(k=v(a),ce=0;ce<k.length;ce++){if(F=k[ce].split("+"),F.length>1&&(Y=B(F),a=F[F.length-1]),a=_(a),i===void 0&&(i=W()),!r[a])return;for(N=0;N<r[a].length;N++)Se=r[a][N],Se.scope===i&&l(Se.mods,Y)&&(r[a][N]={})}}function L(a){return typeof a=="string"&&(a=_(a)),m(h,a)!=-1}function b(){return h.slice(0)}function $(a){var i=(a.target||a.srcElement).tagName;return!(i=="INPUT"||i=="SELECT"||i=="TEXTAREA")}for(t in f)w[t]=!1;function G(a){d=a||"all"}function W(){return d||"all"}function E(a){var i,k,F;for(i in r)for(k=r[i],F=0;F<k.length;)k[F].scope===a?k.splice(F,1):F++}function v(a){var i;return a=a.replace(/\s/g,""),i=a.split(","),i[i.length-1]==""&&(i[i.length-2]+=","),i}function B(a){for(var i=a.slice(0,a.length-1),k=0;k<i.length;k++)i[k]=f[i[k]];return i}function U(a,i,k){a.addEventListener?a.addEventListener(i,k,!1):a.attachEvent&&a.attachEvent("on"+i,function(){k(window.event)})}U(document,"keydown",function(a){p(a)}),U(document,"keyup",g),U(window,"focus",C);var X=n.key;function S(){var a=n.key;return n.key=X,a}n.key=w,n.key.setScope=G,n.key.getScope=W,n.key.deleteScope=E,n.key.filter=$,n.key.isPressed=L,n.key.getPressedKeyCodes=b,n.key.noConflict=S,n.key.unbind=O,e.exports=w})(an)})(Ot);var Z=Ot.exports;const ee=re(),se=e=>`${xt.CTRL}+${e}`,Me=e=>`${xt.SHIFT}+${e}`,J={[D.ARROW_UP]:se("up"),[D.ARROW_RIGHT]:se("right"),[D.ARROW_DOWN]:se("down"),[D.ARROW_LEFT]:se("left"),[D.COPY]:se("c"),[D.CUT]:se("x"),[D.PARSE]:se("v"),[D.DELETE]:"delete",[D.BACK]:se("z"),[D.FORWORD]:se(Me("z")),[D.GROUP]:se("g"),[D.UN_GROUP]:se(Me("g")),[D.LOCK]:se("l"),[D.UNLOCK]:se(Me("l")),[D.HIDE]:se("h"),[D.SHOW]:se(Me("h"))},te=e=>`${Dt.CTRL}+${e}`,Re=e=>`${Dt.SHIFT}+${e}`,V={[D.ARROW_UP]:te("arrowup"),[D.ARROW_RIGHT]:te("arrowright"),[D.ARROW_DOWN]:te("arrowdown"),[D.ARROW_LEFT]:te("arrowleft"),[D.COPY]:te("c"),[D.CUT]:te("x"),[D.PARSE]:te("v"),[D.DELETE]:te("backspace"),[D.BACK]:te("z"),[D.FORWORD]:te(Re("z")),[D.GROUP]:te("g"),[D.UN_GROUP]:te(Re("g")),[D.LOCK]:te("l"),[D.UNLOCK]:te(Re("l")),[D.HIDE]:te("h"),[D.SHOW]:te(Re("h"))},Ln=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],Mn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],Rn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Bn=()=>{const n=(t,r)=>{switch(r){case t.up:Z(r,oe(()=>(ee.setMove(D.ARROW_UP),!1),50));break;case t.right:Z(r,oe(()=>(ee.setMove(D.ARROW_RIGHT),!1),50));break;case t.down:Z(r,oe(()=>(ee.setMove(D.ARROW_DOWN),!1),50));break;case t.left:Z(r,oe(()=>(ee.setMove(D.ARROW_LEFT),!1),50));break;case t.delete:Z(r,Ye(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(r,Ye(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(r,Ye(()=>(ee.setCut(),!1),50));break;case t.parse:Z(r,oe(()=>(ee.setParse(),!1),50));break;case t.back:Z(r,oe(()=>(ee.setBack(),!1),50));break;case t.forward:Z(r,oe(()=>(ee.setForward(),!1),50));break;case t.group:Z(r,oe(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(r,oe(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(r,oe(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(r,oe(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(r,oe(()=>(ee.setHide(),!1),50));break;case t.show:Z(r,oe(()=>(ee.setShow(),!1),50));break}};Ln.forEach(t=>{n(J,t)}),Mn.forEach(t=>{n(V,t)}),Rn()},T=re(),{onClickOutSide:In}=ut(),Hn=e=>we(void 0,null,function*(){e.preventDefault();try{xn();const n=e.dataTransfer.getData(rn.DRAG_KEY);if(!n){vt();return}T.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let r,o;if(t.sourceID){let d=yield Yt(t.sourceID,t.category);if(!d){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}r=d.chartConfig;const f=Gt(d.chartConfig);o=new f.default(d.chartConfig),o=De.exports.merge({},o,d),o.id=un()}else o=yield Xt(t);q(o,e.offsetX-o.attr.w/2,e.offsetY-o.attr.h/2),T.addComponentList(o,!1,!0),T.setTargetSelectChart(o.id),vt()}catch(n){Dn(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),gt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Lt=(e,n)=>{if(n){T.setTargetSelectChart(n.id);return}T.setTargetSelectChart(void 0)},Pn=(e,n)=>{var h;if(e.which==2||(h=window.$KeyboardActive)!=null&&h.space)return;Lt();const t=e.offsetX,r=e.offsetY,o=e.screenX,d=e.screenY,f=T.getEditCanvas.scale;T.setMousePosition(void 0,void 0,t,r);const y=De.exports.throttle(m=>{T.setTargetSelectChart(),T.setEditCanvas(ae.IS_SELECT,!0);const l=t+m.screenX-o,c=r+m.screenY-d;T.setMousePosition(l,c);const u={x1:0,y1:0,x2:0,y2:0};l>t&&c>r?(u.x1=t,u.y1=r,u.x2=Math.round(t+(m.screenX-o)/f),u.y2=Math.round(r+(m.screenY-d)/f)):l>t&&c<r?(u.x1=t,u.y1=Math.round(r-(d-m.screenY)/f),u.x2=Math.round(t+(m.screenX-o)/f),u.y2=r):l<t&&c>r?(u.x1=Math.round(t-(o-m.screenX)/f),u.y1=r,u.x2=t,u.y2=Math.round(r+(m.screenY-d)/f)):(u.x1=Math.round(t-(o-m.screenX)/f),u.y1=Math.round(r-(d-m.screenY)/f),u.x2=t,u.y2=r),T.getComponentList.forEach(p=>{if(!T.getTargetChart.selectId.includes(p.id)){const{x:g,y:C,w,h:O}=p.attr,L={x1:g,y1:C,x2:g+w,y2:C+O};L.x1-u.x1>=0&&L.y1-u.y1>=0&&L.x2-u.x2<=0&&L.y2-u.y2<=0&&!p.status.lock&&!p.status.hide&&T.setTargetSelectChart(p.id,!0)}})},30),_=()=>{y.cancel(),T.setEditCanvas(ae.IS_SELECT,!1),T.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",_)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",_)},Mt=()=>({mouseClickHandle:(o,d)=>{var f;if(o.preventDefault(),o.stopPropagation(),!d.status.lock&&(f=window.$KeyboardActive)!=null&&f.ctrl)if(T.targetChart.selectId.includes(d.id)){const y=T.targetChart.selectId.filter(_=>_!==d.id);T.setTargetSelectChart(y)}else T.setTargetSelectChart(d.id,!0)},mousedownHandle:(o,d)=>{var C;if(o.preventDefault(),o.stopPropagation(),d.status.lock||(In(),o.buttons===Ge.LEFT&&((C=window.$KeyboardActive)==null?void 0:C.ctrl)))return;const f=T.getTargetChart.selectId;if(o.buttons===Ge.RIGHT&&f.length>1&&f.includes(d.id)||(T.setTargetSelectChart(d.id),o.buttons===Ge.RIGHT))return;const y=T.getEditCanvas.scale,_=T.getEditCanvasConfig.width,h=T.getEditCanvasConfig.height,m=new Map;T.getTargetChart.selectId.forEach(w=>{const O=T.fetchTargetIndex(w);if(O!==-1){const{x:L,y:b,w:$,h:G}=cn(T.getComponentList[O]).attr;m.set(w,{x:L,y:b,w:$,h:G})}});const l=o.screenX,c=o.screenY;let u=[];T.getTargetChart.selectId.forEach(w=>{if(!m.has(w))return;const O=T.fetchTargetIndex(w);u.push(De.exports.cloneDeep(T.getComponentList[O]))}),T.setMousePosition(void 0,void 0,l,c);const p=De.exports.throttle(w=>{T.setEditCanvas(ae.IS_DRAG,!0),T.setMousePosition(w.screenX,w.screenY);let O=(w.screenX-l)/y,L=(w.screenY-c)/y;T.getTargetChart.selectId.forEach(b=>{if(!m.has(b))return;const $=T.fetchTargetIndex(b),{x:G,y:W,w:E,h:v}=m.get(b),B=T.getComponentList[$];let U=Math.round(G+O),X=Math.round(W+L);const S=50;U=U<-E+S?-E+S:U,X=X<-v+S?-v+S:X,U=U>_-S?_-S:U,X=X>h-S?h-S:X,B&&!Number.isNaN(U)&&!Number.isNaN(X)&&(B.attr=Object.assign(B.attr,{x:U,y:X}))})},20),g=()=>{try{T.setMousePosition(0,0,0,0),T.setEditCanvas(ae.IS_DRAG,!1),u.length&&(T.getTargetChart.selectId.forEach(w=>{if(!m.has(w))return;const O=T.fetchTargetIndex(w),L=T.getComponentList[O];u.forEach(b=>{b.id===w&&(b.attr=Object.assign(b.attr,{offsetX:L.attr.x-b.attr.x,offsetY:L.attr.y-b.attr.y}))})}),T.moveComponentList(u)),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g)}catch(w){console.log(w)}};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)},mouseenterHandle:(o,d)=>{o.preventDefault(),o.stopPropagation(),T.getEditCanvas.isSelect||T.setTargetHoverChart(d.id)},mouseleaveHandle:(o,d)=>{o.preventDefault(),o.stopPropagation(),T.setEditCanvas(ae.IS_DRAG,!1),T.setTargetHoverChart(void 0)}}),$n=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),T.setEditCanvas(ae.IS_DRAG,!0);const r=T.getEditCanvas.scale,o=t.x,d=t.y,f=t.w,y=t.h,_=t.lockScale,h=t.scaleRatio,m=t.minWidth,l=e.screenX,c=e.screenY,u=f-m;T.setMousePosition(l,c);const p=De.exports.throttle(C=>{T.setMousePosition(C.screenX,C.screenY);let w=Math.round((C.screenX-l)/r),O=Math.round((C.screenY-c)/r);const L=/t/.test(n),b=/b/.test(n),$=/l/.test(n),G=/r/.test(n);let W=y+(L?-O:b?O:0),E=f+($?-w:G?w:0);_&&((L||b)&&(E=Math.round(W*h)),($||G)&&(W=Math.round(E/h))),$&&(E<m&&u>0&&(w=u),u===0&&w>0&&(w=0)),t.h=W>0?W:0,t.w=E>0?E:0,t.x=o+($?w:0),t.y=d+(L?O:0)},50),g=()=>{T.setEditCanvas(ae.IS_DRAG,!1),T.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)};const Un=["onMousedown"],Nn=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const n=e;ke(l=>({"026d39a0":s(f)}));const t=Fe(),r=re(),o=["t","r","b","l","lt","rt","lb","rb"],d=["n","e","s","w","nw","ne","sw","se"],f=H(()=>t.getAppTheme),y=H(()=>n.item.status.lock?!1:n.item.id===r.getTargetChart.hoverId),_=H(()=>{const l=n.item.id;return n.item.status.lock?!1:r.getTargetChart.selectId.find(c=>c===l)}),h=H(()=>n.item.status.lock),m=H(()=>n.item.status.hide);return(l,c)=>(x(),j("div",{class:de(["go-shape-box",{lock:s(h),hide:s(m)}])},[at(l.$slots,"default",{},void 0,!0),e.hiddenPoint?le("",!0):(x(!0),j(he,{key:0},_e(s(_)?o:[],(u,p)=>(x(),j("div",{class:de(`shape-point ${u}`),key:p,style:ne(s(Wt)(u,p,e.item.attr,d)),onMousedown:g=>s($n)(g,u,e.item.attr)},null,46,Un))),128)),z("div",{class:"shape-modal",style:ne(s(Ee)(e.item.attr))},[z("div",{class:de(["shape-modal-select",{active:s(_)}])},null,2),z("div",{class:de(["shape-modal-change",{selectActive:s(_),hoverActive:s(y)}])},null,2)],4)],2))}});var et=ie(Nn,[["__scopeId","data-v-5f8854aa"]]);const Kn={class:"go-edit-group-box"},Yn=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ut(),{mouseenterHandle:r,mouseleaveHandle:o,mousedownHandle:d,mouseClickHandle:f}=Mt(),y=(m,l,c)=>{const u=p=>l.filter(g=>p.includes(g.key));if(n.getTargetChart.selectId.length>1)return u([D.GROUP,D.DELETE]);{const p=[];c.status.lock?p.push(D.LOCK):p.push(D.UNLOCK),c.status.hide?p.push(D.HIDE):p.push(D.SHOW);const g=[D.UN_GROUP];return[...u(g),Tn(),...m.filter(C=>!p.includes(C.key))]}},_=H(()=>{const m=n.getEditCanvasConfig.chartThemeColor;return St[m]}),h=H(()=>n.getEditCanvasConfig.chartThemeSetting);return(m,l)=>(x(),j("div",Kn,[(x(),P(s(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:de(s(Qe)(e.groupData.styles.animations)),style:ne(K(K(K(K(K({},s(Ie)(e.groupData.attr,e.groupIndex)),s(Ee)(e.groupData.attr)),s(He)(e.groupData.styles)),s(Ze)(e.groupData.styles)),s(At)(e.groupData.styles))),onClick:l[0]||(l[0]=c=>s(f)(c,e.groupData)),onMousedown:l[1]||(l[1]=c=>s(d)(c,e.groupData)),onMouseenter:l[2]||(l[2]=c=>s(r)(c,e.groupData)),onMouseleave:l[3]||(l[3]=c=>s(o)(c,e.groupData)),onContextmenu:l[4]||(l[4]=c=>s(t)(c,e.groupData,y))},{default:A(()=>[(x(!0),j(he,null,_e(e.groupData.groupList,c=>(x(),P(s(et),{key:c.id,"data-id":c.id,index:e.groupIndex,item:c,hiddenPoint:!0,style:ne(K({},s(Ie)(c.attr,e.groupIndex)))},{default:A(()=>[(x(),P(Ce(c.chartConfig.chartKey),{class:de(["edit-content-chart",s(Qe)(c.styles.animations)]),chartConfig:c,themeSetting:s(h),themeColor:s(_),style:ne(K(K(K({},s(Ee)(c.attr)),s(He)(c.styles)),s(Ze)(c.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Gn={class:"go-edit-align-line"},Xn=ue({__name:"index",setup(e){ke(p=>({"32d4d33a":s(f)}));const n=Fe(),t=re(),r=rt(),o=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),d=p=>p?{left:`${p.x?p.x:0}px`,top:`${p.y?p.y:0}px`}:{},f=H(()=>n.getAppTheme),y=H(()=>r.getChartAlignRange),_=H(()=>t.getEditCanvas[ae.IS_DRAG]),h=(p,g)=>Math.abs(p-g)<=y.value,m=H(()=>t.getTargetChart.selectId),l=H(()=>t.getComponentList[t.fetchTargetIndex()]),c=H(()=>{var p;return((p=l.value)==null?void 0:p.attr)||{}}),u=H(()=>({id:"0",attr:{w:ft(t.getEditCanvasConfig.width),h:ft(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0,scaleRatio:1.5,lockScale:!1,disabledHeight:!1,minWidth:50}}));return fe(()=>t.getMousePosition,oe(()=>{try{if(!_.value||m.value.length!==1)return;const p=c.value.w,g=c.value.h,C=c.value.x,w=C+p/2,O=C+p,L=[C,w,O],b=c.value.y,$=b+g/2,G=b+g,W=[b,$,G];o.select.clear(),o.sorptioned.y=!1;const E=t.getComponentList.map(v=>({id:v.id,attr:v.attr}));E.push(u.value),o.lineArr.forEach(v=>{E.forEach(B=>{if(m.value[0]===B.id)return;const U=B.attr.w,X=B.attr.h,S=B.attr.x,a=S+U/2,i=S+U,k=[S,a,i],F=B.attr.y,Y=F+X/2,N=F+X,ce=[F,Y,N];v.includes("rowt")&&(h(b,F)&&(o.select.set(v,{y:F}),q(l.value,C,F)),h(b,Y)&&(o.select.set(v,{y:Y}),q(l.value,C,Y)),h(b,N)&&(o.select.set(v,{y:N}),q(l.value,C,N))),v.includes("rowc")&&(h($,F)&&(o.select.set(v,{y:F}),q(l.value,C,F-g/2)),h($,Y)&&(o.select.set(v,{y:Y}),q(l.value,C,Y-g/2)),h($,N)&&(o.select.set(v,{y:N}),q(l.value,C,N-g/2))),v.includes("rowb")&&(h(G,F)&&(o.select.set(v,{y:F}),q(l.value,C,F-g)),h(G,Y)&&(o.select.set(v,{y:Y}),q(l.value,C,Y-g)),h(G,N)&&(o.select.set(v,{y:N}),q(l.value,C,N-g))),v.includes("coll")&&(h(C,S)&&(o.select.set(v,{x:S}),q(l.value,S,b)),h(C,a)&&(o.select.set(v,{x:a}),q(l.value,a,b)),h(C,i)&&(o.select.set(v,{x:i}),q(l.value,i,b))),v.includes("colc")&&(h(w,S)&&(o.select.set(v,{x:S}),q(l.value,S-p/2,b)),h(w,a)&&(o.select.set(v,{x:a}),q(l.value,a-p/2,b)),h(w,i)&&(o.select.set(v,{x:i}),q(l.value,i-p/2,b))),v.includes("colr")&&(h(O,S)&&(o.select.set(v,{x:S}),q(l.value,S-p,b)),h(O,a)&&(o.select.set(v,{x:a}),q(l.value,a-p,b)),h(O,i)&&(o.select.set(v,{x:i}),q(l.value,i-p,b)))})})}catch(p){console.log(p)}},200),{deep:!0}),fe(()=>_.value,p=>{p||(o.select.clear(),o.sorptioned.y=!1)}),(p,g)=>(x(),j("div",Gn,[(x(!0),j(he,null,_e(o.lineArr,C=>(x(),j("div",{class:de(["line",[C.includes("row")?"row":"col",o.select.has(C)&&"visible"]]),key:C,style:ne(d(o.select.get(C)))},null,6))),128))]))}});var Wn=ie(Xn,[["__scopeId","data-v-41123ead"]]);const zn=ue({__name:"index",setup(e){return(n,t)=>{const r=I("n-watermark");return x(),P(r,{id:"go-edit-watermark",content:s(ln),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var jn=ie(zn,[["__scopeId","data-v-e5cd93da"]]);const Rt=e=>(kt("data-v-6aae2e54"),e=e(),Ft(),e),qn=Rt(()=>z("div",{class:"select-background"},null,-1)),Jn=Rt(()=>z("div",{class:"select-border"},null,-1)),Vn=[qn,Jn],Qn=ue({__name:"index",setup(e){ke(y=>({bb49f51e:s(d)}));const n=Fe(),t=re(),{isSelect:r,scale:o}=Ue(t.getEditCanvas),d=H(()=>n.getAppTheme),f=Q();return fe(()=>t.getMousePosition,y=>{if(!r.value)return;const{startX:_,startY:h,x:m,y:l}=y,c={zIndex:pt,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0,lockScale:!1,scaleRatio:1.5,disabledHeight:!1,minWidth:50};m>_&&l>h?(c.x=_,c.y=h,c.w=Math.round((m-_)/o.value),c.h=Math.round((l-h)/o.value)):m>_&&l<h?(c.x=_,c.w=Math.round((m-_)/o.value),c.h=Math.round((h-l)/o.value),c.y=h-c.h):m<_&&l>h?(c.y=h,c.w=Math.round((_-m)/o.value),c.h=Math.round((l-h)/o.value),c.x=_-c.w):(c.w=Math.round((_-m)/o.value),c.h=Math.round((h-l)/o.value),c.x=_-c.w,c.y=h-c.h),f.value=K(K({},Ie(c,pt)),Ee(c))},{deep:!0}),(y,_)=>s(r)?(x(),j("div",{key:0,class:"go-edit-select",style:ne(f.value)},Vn,4)):le("",!0)}});var Zn=ie(Qn,[["__scopeId","data-v-6aae2e54"]]);const es=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:r}=Ue(n),o=H(()=>({w:t.value.width,h:t.value.height})),d=H(()=>{const y={transform:`scale(${r.value.scale})`};return K(K({},Ee(o.value)),y)}),f=H(()=>{const y=r.value.isCreate&&{"z-index":99999};return K(K({},Ee(o.value)),y)});return(y,_)=>(x(),j("div",{class:"go-edit-range go-transition",style:ne(s(d)),onMousedown:_[0]||(_[0]=h=>s(Pn)(h,void 0))},[at(y.$slots,"default",{},void 0,!0),M(s(jn)),M(s(Wn)),M(s(Zn)),z("div",{class:"go-edit-range-model",style:ne(s(f))},null,4)],36))}});var ts=ie(es,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var qe={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",qe,qe),window.removeEventListener("test",qe,!0))}catch(e){}function ns(e,n,t,r){if(r&&typeof r!="boolean"&&!nt){var o=r.once,d=r.capture,f=t;!nt&&o&&(f=t.__once||function y(_){this.removeEventListener(n,y,d),t.call(this,_)},t.__once=f),e.addEventListener(n,f,tt?r:d)}e.addEventListener(n,t,r)}function ss(e,n,t,r){var o=r&&typeof r!="boolean"?r.capture:r;e.removeEventListener(n,t,o),t.__once&&e.removeEventListener(n,t.__once,o)}function _t(e,n,t,r){return ns(e,n,t,r),function(){ss(e,n,t,r)}}var mt=new Date().getTime();function os(e){var n=new Date().getTime(),t=Math.max(0,16-(n-mt)),r=setTimeout(e,t);return mt=n,r}var as=["","webkit","moz","o","ms"],Ct=os,yt=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&as.some(function(e){var n=yt(e,"request");return n in window&&(yt(e,"cancel"),Ct=function(r){return window[n](r)}),!!Ct});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const rs={class:"go-sketch-rule"},us={key:1,class:"fix-edit-screens-block"},cs=ue({__name:"index",setup(e){ke(S=>({"0c493a2c":s(G),"57d4e729":c.value}));const n=re(),t=zt(),r=Fe(),o=20;let d=[0,0],f=[0,0];const y=Q(),_=Q(!0),h=Q(),m=Q(),l=Q(!1),c=Q("auto"),{width:u,height:p}=Ue(n.getEditCanvasConfig),g=Q(0),C=Q(0),w=$e({h:[],v:[]}),O=H(()=>n.getEditCanvas.scale),L=H(()=>u.value*2),b=H(()=>p.value*2),$=H(()=>r.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),G=H(()=>r.getAppTheme),W=S=>{if(S.ctrlKey||S.metaKey){S.preventDefault();let a=O.value;if(S.wheelDelta>=0&&O.value<2){a=O.value+.05,n.setScale(a);return}S.wheelDelta<0&&O.value>.1&&(a=O.value-.05,n.setScale(a))}},E=()=>{if(!y.value)return;const S=y.value.getBoundingClientRect(),a=h.value.getBoundingClientRect();g.value=(S.left+o-a.left)/O.value,C.value=(S.top+o-a.top)/O.value},v=S=>{var Y,N;if(S.preventDefault(),S.stopPropagation(),S.which==2)l.value=!0;else if(!((Y=window.$KeyboardActive)!=null&&Y.space))return;(N=document.activeElement)==null||N.blur();const a=S.pageX,i=S.pageY,k=_t(window,"mousemove",ce=>{const Se=ce.pageX-a,Ht=ce.pageY-i,[Ne,be]=d,[Ke,Oe]=f;d=[be,Se],f=[Oe,Ht],y.value.scrollLeft-=be>Ne?Math.abs(be-Ne):-Math.abs(be-Ne),y.value.scrollTop-=Oe>Ke?Math.abs(Oe-Ke):-Math.abs(Oe-Ke)}),F=_t(window,"mouseup",()=>{k(),F(),d=[0,0],f=[0,0],l.value=!1})},B=()=>{const S=document.getElementById("go-chart-edit-layout");return S?{height:S.clientHeight-25,width:S.clientWidth}:{width:u.value,height:p.value}},U=()=>{_.value=!1,setTimeout(()=>{_.value=!0},10)},X=()=>{const{width:S,height:a}=B();y.value.scrollLeft=L.value/2-S/2,y.value.scrollTop=b.value/2-a/2};return fe(()=>L.value,()=>{X(),n.computedScale()}),fe(()=>r.getDarkTheme,()=>{U()}),fe(()=>O.value,(S,a)=>{a!==S?(t.setItemUnHandle(jt.RE_POSITION_CANVAS,!1),E(),setTimeout(()=>{X(),U()},400)):oe(U,20)}),fe(()=>l.value,S=>{c.value=S?"grab":"auto"}),ot(()=>{y.value&&(y.value.addEventListener("wheel",W,{passive:!1}),X())}),Tt(()=>{y.value&&y.value.removeEventListener("wheel",W)}),window.onKeySpacePressHold=S=>{l.value=S},(S,a)=>{const i=I("sketch-rule");return x(),j("div",rs,[_.value?(x(),P(i,{key:0,thick:o,scale:s(O),width:B().width,height:B().height,startX:g.value,startY:C.value,lines:w,palette:s($)},null,8,["scale","width","height","startX","startY","lines","palette"])):le("",!0),z("div",{ref_key:"$app",ref:y,class:"edit-screens",onScroll:E},[z("div",{ref_key:"$container",ref:m,class:"edit-screen-container",style:ne({width:s(L)+"px",height:s(b)+"px"})},[z("div",{ref_key:"refSketchRuleBox",ref:h,class:"canvas",onMousedown:v,style:ne({marginLeft:"-"+(B().width/2-25)+"px"})},[z("div",{style:ne({pointerEvents:l.value?"none":"auto"})},[at(S.$slots,"default",{},void 0,!0)],4)],36)],4)],544),s(r).getDarkTheme?(x(),j("div",us)):le("",!0)])}}});var ls=ie(cs,[["__scopeId","data-v-2f924d76"]]);const Je={[R.ADD]:"\u65B0\u589E",[R.DELETE]:"\u5220\u9664",[R.UPDATE]:"\u66F4\u65B0",[R.MOVE]:"\u79FB\u52A8",[R.PASTE]:"\u7C98\u8D34",[R.COPY]:"\u590D\u5236",[R.CUT]:"\u526A\u5207",[R.TOP]:"\u7F6E\u9876",[R.BOTTOM]:"\u7F6E\u5E95",[R.UP]:"\u4E0A\u79FB",[R.DOWN]:"\u4E0B\u79FB",[R.GROUP]:"\u6210\u7EC4",[R.UN_GROUP]:"\u89E3\u7EC4",[R.LOCK]:"\u9501\u5B9A",[R.UNLOCK]:"\u89E3\u9501",[R.HIDE]:"\u9690\u85CF",[R.SHOW]:"\u663E\u793A",[Be.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var is=Array.prototype,ds=is.reverse;function fs(e){return e==null?e:ds.call(e)}var ps=fs;const It=e=>(kt("data-v-5a4fd660"),e=e(),Ft(),e),hs={class:"go-flex-items-center"},vs=It(()=>z("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),gs={class:"history-list-box"},_s=["title"],ms=It(()=>z("div",{class:"popover-modal"},null,-1)),Cs=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:r,CopyIcon:o,LayersIcon:d,DuplicateIcon:f,HelpOutlineIcon:y,LockClosedOutlineIcon:_,LockOpenOutlineIcon:h,EyeOffOutlineIcon:m,EyeOutlineIcon:l}=Ae.ionicons5,{StackedMoveIcon:c,Carbon3DCursorIcon:u,Carbon3DSoftwareIcon:p}=Ae.carbon,g=qt(),C=L=>{if(L.targetType===Be.CANVAS)return n;switch(L.actionType){case R.UPDATE:return t;case R.DELETE:return r;case R.PASTE:return o;case R.TOP:return d;case R.BOTTOM:return d;case R.UP:return d;case R.DOWN:return d;case R.MOVE:return c;case R.ADD:return f;case R.GROUP:return u;case R.UN_GROUP:return p;case R.LOCK:return _;case R.UNLOCK:return h;case R.HIDE:return m;case R.SHOW:return l;default:return t}},w=L=>{if(L.targetType===Be.CANVAS)return Je[Be.CANVAS];if(L.actionType===R.GROUP||L.actionType===R.UN_GROUP)return`${Je[L.actionType]}`;if(L.historyData.length)return`${Je[L.actionType]} - ${L.historyData[0].chartConfig.title}`},O=H(()=>{const b=g.getBackStack.map($=>({label:w($),icon:C($)}));return ps(b.filter($=>$.label))});return(L,b)=>{const $=I("n-button"),G=I("n-icon"),W=I("n-text"),E=I("n-scrollbar"),v=I("n-popover"),B=I("n-tooltip");return x(),j("div",hs,[M(v,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:A(()=>[M($,{class:"mr-10",secondary:"",size:"small",disabled:s(O).length===0},{default:A(()=>[vs]),_:1},8,["disabled"])]),default:A(()=>[z("div",gs,[M(E,{style:{"max-height":"500px"}},{default:A(()=>[(x(!0),j(he,null,_e(s(O),(U,X)=>(x(),j("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:X,title:U.label},[M(G,{class:"item-icon",size:"16",depth:2,component:U.icon},null,8,["component"]),M(W,{depth:"2"},{default:A(()=>[ye(pe(U.label),1)]),_:2},1024)],8,_s))),128))]),_:1}),ms])]),_:1}),M(B,{trigger:"hover"},{trigger:A(()=>[M(G,{size:"21",depth:3},{default:A(()=>[M(s(y))]),_:1})]),default:A(()=>[z("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+pe(s(dn))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var ys=ie(Cs,[["__scopeId","data-v-5a4fd660"]]);const Es={class:"go-edit-bottom"},Ss=ue({__name:"index",setup(e){ke(C=>({f3add9fc:o.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=Ae.ionicons5,r=Fe(),o=Q(r.getAppTheme),d=re(),{lockScale:f,scale:y}=Ue(d.getEditCanvas);let _=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const h=Q(""),m=C=>{if(C===0){d.computedScale();return}d.setScale(C/100)},l=()=>{d.setEditCanvas(ae.LOCK_SCALE,!f.value)},c=Q(100),u=C=>`${C}%`,p=C=>{d.setScale(C/100)},g=$e({100:""});return fn(()=>{const C=(y.value*100).toFixed(0);h.value=`${C}%`,c.value=parseInt(C)}),(C,w)=>{const O=I("n-text"),L=I("n-space"),b=I("n-select"),$=I("n-icon"),G=I("n-button"),W=I("n-tooltip"),E=I("n-slider");return x(),j("div",Es,[M(L,null,{default:A(()=>[M(s(ys)),M(O,{id:"keyboard-dress-show",depth:"3"})]),_:1}),M(L,{class:"bottom-ri"},{default:A(()=>[M(Fn),M(b,{disabled:s(f),class:"scale-btn",value:h.value,"onUpdate:value":[w[0]||(w[0]=v=>h.value=v),m],size:"mini",options:s(_)},null,8,["disabled","value","options"]),M(W,{trigger:"hover"},{trigger:A(()=>[M(G,{onClick:l,text:""},{default:A(()=>[M($,{class:de(["lock-icon",{color:s(f)}]),size:"18",depth:2},{default:A(()=>[s(f)?(x(),P(s(n),{key:0})):(x(),P(s(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:A(()=>[z("span",null,pe(s(f)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),M(E,{class:"scale-slider",value:c.value,"onUpdate:value":[w[1]||(w[1]=v=>c.value=v),p],"default-value":50,min:10,max:200,step:5,"format-tooltip":u,disabled:s(f),marks:g},null,8,["value","disabled","marks"])]),_:1})])}}});var ws=ie(Ss,[["__scopeId","data-v-99a534fc"]]);const Ts=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,{HelpOutlineIcon:r,CloseIcon:o}=Ae.ionicons5,d=rt(),f=Q(!1),y=$e([{key:ve.ASIDE_ALL_COLLAPSED,value:d.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ve.HIDE_PACKAGE_ONE_CATEGORY,value:d.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ve.CHANGE_LANG_RELOAD,value:d.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_TOOLS_STATUS_HIDE,value:d.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ve.CHART_TOOLS_STATUS,value:d.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_MOVE_DISTANCE,value:d.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ve.CHART_ALIGN_RANGE,value:d.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);fe(()=>t.modelShow,m=>{f.value=m});const _=()=>{n("update:modelShow",!1)},h=(m,l)=>{d.setItem(l.key,l.value)};return(m,l)=>{const c=I("n-h3"),u=I("n-icon"),p=I("n-space"),g=I("n-divider"),C=I("n-text"),w=I("n-switch"),O=I("n-input-number"),L=I("n-select"),b=I("n-tooltip"),$=I("n-list-item"),G=I("n-list"),W=I("n-modal");return x(),P(W,{show:f.value,"onUpdate:show":l[0]||(l[0]=E=>f.value=E),onAfterLeave:_},{default:A(()=>[M(G,{bordered:"",class:"go-system-setting"},{header:A(()=>[M(p,{justify:"space-between"},{default:A(()=>[M(c,{class:"go-mb-0"},{default:A(()=>[ye("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),M(u,{size:"20",class:"go-cursor-pointer",onClick:_},{default:A(()=>[M(s(o))]),_:1})]),_:1})]),default:A(()=>[(x(!0),j(he,null,_e(y,E=>(x(),P($,{key:E.key},{default:A(()=>[E.type==="divider"?(x(),P(g,{key:0,style:{margin:"0"}})):(x(),P(p,{key:1,size:40},{default:A(()=>[M(p,null,{default:A(()=>[M(C,{class:"item-left"},{default:A(()=>[ye(pe(E.name),1)]),_:2},1024),E.type==="switch"?(x(),P(w,{key:0,value:E.value,"onUpdate:value":[v=>E.value=v,v=>h(v,E)],size:"small"},null,8,["value","onUpdate:value"])):E.type==="number"?(x(),P(O,{key:1,value:E.value,"onUpdate:value":[v=>E.value=v,v=>h(v,E)],class:"input-num-width",size:"small",step:E.step||null,suffix:E.suffix||null,min:E.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):E.type==="select"?(x(),P(L,{key:2,class:"select-min-width",value:E.value,"onUpdate:value":[v=>E.value=v,v=>h(v,E)],size:"small",options:E.options},null,8,["value","onUpdate:value","options"])):le("",!0)]),_:2},1024),M(p,null,{default:A(()=>[M(C,{class:"item-right"},{default:A(()=>[ye(pe(E.desc),1)]),_:2},1024),E.tip?(x(),P(b,{key:0,trigger:"hover"},{trigger:A(()=>[M(u,{size:"21"},{default:A(()=>[M(s(r))]),_:1})]),default:A(()=>[z("span",null,pe(E.tip),1)]),_:2},1024)):le("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var xs=ie(Ts,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),Ds=()=>{xe.setTargetSelectChart(void 0),pn(hn(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{vn(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var st=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(st||{});const As=()=>{const e=Q(),{updateComponent:n}=wt();return{importUploadFileListRef:e,importBeforeUpload:({file:o})=>{e.value=[];const d=o.file.type;return d!==st.JSON&&d!==st.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:o=>{const{file:d}=o;gn(()=>{d.file?_n(d.file).then(f=>{An({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>we(void 0,null,function*(){try{f=Ve(f),yield n(f,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>we(void 0,null,function*(){try{f=Ve(f),yield n(f,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:ks,dataSyncUpdate:Et}=wt(),Fs=re(),bs=()=>{const e=d=>ks(d.detail,!0,!1),n=()=>we(void 0,null,function*(){Et&&(yield Et()),dispatchEvent(new CustomEvent(Xe.CHART,{detail:Fs.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Xe.JSON,e)},r=()=>{removeEventListener(Xe.JSON,e),removeEventListener("blur",n)};return(d,f)=>{f==ht.CHART_HOME_NAME&&r(),d==ht.CHART_HOME_NAME&&t()}},Os=()=>{const e=bt();fe(()=>e.name,bs(),{immediate:!0})};var ge=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(ge||{});const Ls={class:"btn-item"},Ms=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:r,SettingsSharpIcon:o,CreateIcon:d}=Ae.ionicons5,f=rt(),y=re();bt(),Os();let _=null;const h=Q(!1),m=Q(!0),l=Q(!0),{importUploadFileListRef:c,importCustomRequest:u,importBeforeUpload:p}=As(),g=H(()=>f.getChartToolsStatus===Pe.ASIDE),C=H(()=>f.getChartToolsStatusHide),w=H(()=>m.value&&C.value),O=H(()=>{if(!g.value)return W;const E=[];return W.map(v=>{E.unshift(v)}),E}),L=()=>{_=setTimeout(()=>{m.value&&(m.value=!1,l.value=!0)},200),setTimeout(()=>{l.value=!1},400)},b=()=>{clearTimeout(_),m.value||(m.value=!0)},$=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const E=Cn(yn.CHART_EDIT_NAME,"href");if(!E)return;const v=En();G(v),Sn(E,[v],void 0,!0)},1e3)},G=E=>{const v=y.getStorageInfo,B=wn(Le.GO_CHART_STORAGE_LIST)||[];if(B!=null&&B.length){const U=B.findIndex(X=>X.id===E);U!==-1?(B.splice(U,1,me(K({},v),{id:E})),je(Le.GO_CHART_STORAGE_LIST,B)):(B.push(me(K({},v),{id:E})),je(Le.GO_CHART_STORAGE_LIST,B))}else je(Le.GO_CHART_STORAGE_LIST,[me(K({},v),{id:E})])},W=[{key:"import",type:ge.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:ge.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:Ds},{key:"edit",type:ge.BUTTON,name:"\u7F16\u8F91",icon:d,handle:$},{key:"setting",type:ge.BUTTON,name:"\u8BBE\u7F6E",icon:o,handle:()=>{h.value=!0}}];return(E,v)=>{const B=I("n-icon"),U=I("n-text"),X=I("n-button"),S=I("n-upload"),a=I("n-tooltip");return x(),j(he,null,[z("div",{class:de(["go-chart-edit-tools",[s(f).getChartToolsStatus,s(w)?"isMini":"unMini"]]),onClick:v[1]||(v[1]=i=>m.value&&(m.value=!1)),onMouseenter:L,onMouseleave:b},[We(M(B,{class:"asideLogo",size:"22"},{default:A(()=>[M(s(r))]),_:1},512),[[ze,s(f).getChartToolsStatus===s(Pe).ASIDE&&s(w)]]),(x(!0),j(he,null,_e(s(O),(i,k)=>(x(),P(a,{key:i.key,disabled:!s(g)||s(C)&&l.value,trigger:"hover",placement:"left"},{trigger:A(()=>[z("div",Ls,[i.type===s(ge).BUTTON?(x(),P(X,{key:0,circle:s(g),secondary:"",onClick:i.handle},{icon:A(()=>[s(g)?(x(),P(B,{key:0,size:"22"},{default:A(()=>[(x(),P(Ce(i.icon)))]),_:2},1024)):(x(),P(Ce(i.icon),{key:1}))]),default:A(()=>[We(M(U,{depth:"3"},{default:A(()=>[ye(pe(i.name),1)]),_:2},1536),[[ze,!s(g)]])]),_:2},1032,["circle","onClick"])):i.type===s(ge).IMPORTUPLOAD?(x(),P(S,{key:1,"file-list":s(c),"onUpdate:fileList":v[0]||(v[0]=F=>mn(c)?c.value=F:null),"show-file-list":!1,customRequest:s(u),onBeforeUpload:s(p)},{default:A(()=>[M(X,{circle:s(g),secondary:""},{icon:A(()=>[s(g)?(x(),P(B,{key:0,size:"22"},{default:A(()=>[(x(),P(Ce(i.icon)))]),_:2},1024)):(x(),P(Ce(i.icon),{key:1}))]),default:A(()=>[We(M(U,{depth:"3"},{default:A(()=>[ye(pe(i.name),1)]),_:2},1536),[[ze,!s(g)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):le("",!0)])]),default:A(()=>[z("span",null,pe(i.name),1)]),_:2},1032,["disabled"]))),128))],34),M(s(xs),{modelShow:h.value,"onUpdate:modelShow":v[2]||(v[2]=i=>h.value=i)},null,8,["modelShow"])],64)}}});var Rs=ie(Ms,[["__scopeId","data-v-4c257f27"]]);const Bs=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ut();On();const{mouseenterHandle:r,mouseleaveHandle:o,mousedownHandle:d,mouseClickHandle:f}=Mt(),y=(l,c,u)=>{if(n.getTargetChart.selectId.length>1)return c.filter(g=>[D.GROUP,D.DELETE].includes(g.key));const p=[];return u.status.lock?p.push(D.LOCK):p.push(D.UNLOCK),u.status.hide?p.push(D.HIDE):p.push(D.SHOW),l.filter(g=>!p.includes(g.key))},_=H(()=>n.getEditCanvasConfig.chartThemeSetting),h=H(()=>{const l=n.getEditCanvasConfig.chartThemeColor;return St[l]});H(()=>n.getEditCanvasConfig.filterShow);const m=H(()=>{const l=n.getEditCanvasConfig.background,c=n.getEditCanvasConfig.backgroundImage,g=n.getEditCanvasConfig.selectColor?{background:l||void 0}:{background:`url(${c}) no-repeat center center / cover !important`};return me(K({},g),{width:"inherit",height:"inherit"})});return ot(()=>{Bn()}),(l,c)=>(x(),P(s(kn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:s(Lt),onDrop:s(Hn),onDragover:s(gt),onDragenter:s(gt)},{aside:A(()=>[M(s(Rs))]),bottom:A(()=>[M(s(ws))]),default:A(()=>[M(s(ls),null,{default:A(()=>[z("div",{id:"go-chart-edit-content",onContextmenu:c[0]||(c[0]=(...u)=>s(t)&&s(t)(...u))},[M(s(ts),null,{default:A(()=>[z("div",{style:ne(K(K({},s(He)(s(n).getEditCanvasConfig)),s(m)))},[(x(!0),j(he,null,_e(s(n).getComponentList,(u,p)=>(x(),j("div",{key:u.id},[u.isGroup?(x(),P(s(Yn),{key:0,groupData:u,groupIndex:p},null,8,["groupData","groupIndex"])):(x(),P(s(et),{key:1,"data-id":u.id,index:p,style:ne(K(K({},s(Ie)(u.attr,p)),s(At)(u.styles))),item:u,onClick:g=>s(f)(g,u),onMousedown:g=>s(d)(g,u),onMouseenter:g=>s(r)(g,u),onMouseleave:g=>s(o)(g,u),onContextmenu:g=>s(t)(g,u,y)},{default:A(()=>{var g,C,w,O;return[s(Jt)(u)&&!((g=u.option)!=null&&g.isDeleted)?(x(),P(s(Vt),{key:0,title:s(Qt)(u),attr:u.attr,titleSize:s(Zt)(u),titleStyle:s(en)(u)},null,8,["title","attr","titleSize","titleStyle"])):le("",!0),s(tn)(u)&&!((C=u.option)!=null&&C.isDeleted)?(x(),P(s(nn),{key:1,class:"filter-content",componentIdx:u.id,attr:u.attr,filters:u.chartConfig.filters,type:u.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):le("",!0),(w=u.option)!=null&&w.isDeleted?(x(),P(s(bn),{key:2,item:u,style:ne(me(K({},s(it)(u.attr,0)),{lineHeight:u.attr.h+"px"}))},null,8,["item","style"])):le("",!0),(O=u.option)!=null&&O.isDeleted?le("",!0):(x(),P(Ce(u.chartConfig.chartKey),{key:3,class:de(["edit-content-chart",s(Qe)(u.styles.animations)]),chartConfig:u,themeSetting:s(_),themeColor:s(h),style:ne(K(K(K({},s(it)(u.attr,s(sn)(u)+s(on)(u))),s(He)(u.styles)),s(Ze)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]}),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var js=ie(Bs,[["__scopeId","data-v-f20efb74"]]);export{js as default};
